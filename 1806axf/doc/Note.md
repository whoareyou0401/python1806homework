## 爱鲜蜂
- 水果电商应用
- 倒闭了好几次
- 满100减99优惠券
    - 100块钱一盒苹果，六个进口苹果

#### 需求分析
- 主页面
    - 首页
        - 最简单的
        - 内容多，但是逻辑简单
    - 闪购
        - 级联数据操作
    - 我的
        - 个人中心
        - 登录，注册，忘记密码，用户激活
    - 购物车
        - 难点
        - 需要级联商品和用户数据
- 二级功能
    - 下单
        - 订单流转
    - 地址管理
        - 一对多
    - 优惠券
    - 评价管理
    
#### 开发步骤
- 创建项目
- 导入通用资源
    - 静态资源
        - jQuery
        - Bootstrap
        - Swiper
    - 工具类
- 搭建基础架构
- 按照模块或功能进行划分
- 模块具体实现


#### 尺寸单位
- px
- em
    - 相对单位
    - 相对于父级元素
    - font-size
    - 默认1em = 16px
- rem
    - 相对单位
    - 相对与root根的
    - font-size
    - 默认 1rem = 16px
    
- 将屏幕宽度划分为10份，没一份就是1rem
    - 1rem 代表屏幕宽度的十分之一

#### 模块实现
- 所有的开发都是从数据开始的
- 数据库，模型
- 首页面
    - 最简单的
- 建模
- 插入数据
- 读取数据，传递给模板
- 渲染模板


#### 首页
- 数据加载
- 轮播
    - 从数据开发
    - 从模型
        - 定义模型
        - 模型映射数据库
        - 插入数据
    - 查询数据
    - 渲染模板
- 导航

#### 闪购
- 左右俩块
    - 左边是大类型划分
    - 右边根据大类型进行的展示
        - 根据小类型继续展示
        - 根据规则排序
- 大类型划分
    - 就是对数据的筛选
    - filter(xxx)  categoryid
- 小类型划分
    - filter(yyy)  chilidcid


#### 我的
- 用户系统
    - 级联数据
        - 订单
        - 收货地址
        - 优惠券
        - 评价
        - 积分
        - 收藏
        
- 用户表设计
    - 用户名
    - 密码
    - 邮箱/电话
    - 头像
    - 逻辑删除
    - 是否激活
- 密码封装
    - 属于面向三大特性之一
    - 简化操作
        - 存密码的时候，直接调用函数，就可以帮你实现密码，数据安全的存储
        - 密码验证调用函数就ok
    - sha摘要算法
        - 可以直接进行验证
        - 减少失误几率
      
        
#### 状态码
- 2XX 成功
- 3XX 重定向
- 4XX 客户端错了
- 5XX 服务器错误
- 6xx-9xx


#### 用户注册
- 用户表添加数据
- 客户端将用户信息传递给服务器，服务器进行保存
    - 扩展，校验
    - 用户名预校验
        - 当出入过用户名之后
        - 前端通过ajax技术，将用户名发送给服务器
        - 服务器收到用户名，拿着用户名去用户表中比对，使用JSON轻量级数据交换格式进行传输
        - js中收到服务端的响应，根据状态码设置不同的状态
    - 提交校验
        - onsubmit中可以对输入的内容校验
        - 通过返回boolean确认是否可以提交
        - false代表不可提交，true反之
        - 预校验了密码和确认密码，直接对比值就ok
        - 根据输入框的状态确认是否可以提交，指的用户名和邮箱爆红，获取颜色，比对颜色的rgb值
    - 数据安全
        - 使用两套hash算法实现数据安全
            - 在用户密码存储的时候使用，sha512，为了防家贼，防服务器开发人员
            - 在用户点击提交之后，在传输过程中，防止外人，使用md5


#### 用户激活
- 邮箱激活
    - 发送邮件
    - 邮件中存在链接，可以激活账户
        - 激活链接中包含查找用户的标识
- 手机短信激活
- 实名认证激活


#### 邮件发送
- 收件地址
- 邮件服务器
- 邮件服务器中用户
    - 用户名
    - 密码

#### 账户激活
- 首先拥有账户激活接口
    - 接口中获取到用户的方式
    - token，某一个关键字段
- 激活操作限制
    - 时效性
        - 使用redis，cache进行数据缓存，设置过期时间
    - 次数
        - 使用次数仅有一次
        - 只要获取过token，之后直接删除token


#### 购物车
- 需要和用户挂钩，用户登录了才能加购物车（cookie）
- 需要和商品挂钩
- 购买商品数量
- 商品选择
- 购物车中一行代表用户和商品的购买意向关系
    - 用户和商品是多对多的一个关系
    - 手动维护关系表
    - 关系表就是购物车表

##### 添加购物车
- 需要用户和商品添加到购物车中
- 点击的时候获取商品的唯一标识 goodsid
- 在服务器收到goodsid之后，还要获取用户信息
- 用户信息不存在，我们需要跳转到登录页面
    - 重定向是浏览器的行为
    - ajax不能正确理解
    - ajax 更喜欢的轻量级的数据格式交互JSON
    - 未登录
        - 在JSON数据中传递一个特殊信息，让我们进行页面跳转（JS）
        - 使用了JS的BOM中的window
        - window.open(),指定target为_self，在当前浏览器切换
    - 登录了
        - 应该在服务器中将数据处理好
            - 先查询
            - 数据存在做数量增加
            - 不存在则创建
        - 通知前端更新，goods_num
- 购物车数据展示
    - 根据用户，查出用户的所有购物车数据
    - 使用ajax和服务器交互
    - 通过购物车id进行对应数据查询
    - 如果数量为0，我们就要删除cart表中数据
    - 前端页面也需要删掉
    - 如果数据不为0，就做数据展示


#### 购物车逻辑
- 商品和用户的购买关系，是多对多
- ManyToManyField 
    - 可以表述多对多关系
    - 生成了一张额外的关系表
    - 关系表中通过两个外键来实现的
    - 两个外键分别指向关联数据的主键
    - 关系表自己生成的，字段不好定制，关系不好维护
- 手动实现多对多
    - 自己创建一个模型
    - 在模型中使用两个外键建立关联
    - 额外可以添加自己所需字段
        - 商品数量
        - 商品选中状态
    - 手动维护唯一关系，在添加的时候，对数据进行判定
        - 如果数据存在则进行数量添加
        - 如果数据不存在，则创建新数据
    - 移除购物车
        - 先去获取
        - 进行数量判断
        - 数量为1，直接删除
        - 数量大于一，则是减一存储
 
#### 订单
- 从购物车下单
    - 将选中的商品进行下单
    - 筛选出选中的商品
    - 将选中的商品发送给服务器
- 生成订单
    - xxx    
    
#### 订单支付
- 没有账号
    - 支付宝商家账号
    - 必须提供企业营业执照
- 支付宝
    - 根本不提供python支付的调用接口
    - 已提供 
        - java
        - php
        - .net
    - github把java翻译了一遍
        - python把java重写了一遍
    - ping++
        - 支付平台
        - 快速集成各种支付的平台
   


#### 购物车
- 用来存放用户意向购买的商品
- 关键核心点
    - 用户
    - 商品
- 购物车表明的用户商品关系模型
    - ManyToMany
    - 通过两个外键来实现关系的
    - 购物车就是用户和商品的关系表
- 购物车字段设计
    - 用户
    - 商品
    - 商品数量
- 数据操作
    - 添加数据
        - 添加的应该先判断数据是否存在
        - 数据存在做数据加一
        - 如果不存在则创建数据
    - 减少数据
        - 减少也需要判断数量
        - 数量为一的直接删除整条数据
        - 数量大于一则执行减一操作
- 购物车数据状态
    - 商品关系状态，选中和未选中
    - 商品状态切换
        - 点击修改状态
        - 点击的时候获取到商品唯一标识
        - 通过标识找到商品
        - 商品状态修改
    - 全选，商品状态关联
        - 当所有选中状态的时候，全选是选中的
        - 当商品中出现一个未选中的，全选就是未选中的
        - 切换状态
            - 全选按钮
                - 全选点击的时候需要，判断当前购物车中商品状态
                - 商品如果全都是选中的，将商品都变成未选中
                - 商品如果有未选中的，将商品全部变成选中
            - 商品按钮
                - 如果商品变成选中，需要判断全选按钮是否变成选中
                - 如果商品变成未选中，全选变成未选中
- 价钱变更
    - 购物车中只要商品信息发生改变，就需要修改，计算价钱
- 下单
    - 就是将购物车转换成订单表的数据
    - 转换关系
        - 一个订单对应多个购物车数据
    - 设计订单表
        - Order表，
            - 用户
            - 状态
            - 时间
        - OrderGoods表
            - 存放订单的对应的商品
            - 就是购物车中的数据
    - 数据转换
        - 下单的时候，生成一个订单
        - 将要下单的数据从购物车中查找出来
        - 导入到订单商品表中
        - 删除购物车数据


#### 项目部署
-  DEBUG 关掉
    - django自带的开发者服务器就不能提供静态资源文件
- 选服务器
    - Nginx（选）
    - Apache  


#### Chrome插件
- JSONView
- POSTMan 


#### 细节点
- ifequal
    - 判断是类型和值
    - ===
- 运算
    - 运算不是精准运算
    - 运算越复杂越有小误差
    - 解决方案
        - 对结果进行格式化（简单暴力）
        - Decimal （可以定义整数位数，小数位数）

#### 快捷键
- shift + f6 
    - 重构，重命名
    - 修改数据的名字，并且修改引用数据名字的资源


#### 前端
- VUE
